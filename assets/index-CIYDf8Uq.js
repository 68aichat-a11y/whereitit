(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const o of r)if(o.type==="childList")for(const s of o.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&i(s)}).observe(document,{childList:!0,subtree:!0});function n(r){const o={};return r.integrity&&(o.integrity=r.integrity),r.referrerPolicy&&(o.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?o.credentials="include":r.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function i(r){if(r.ep)return;r.ep=!0;const o=n(r);fetch(r.href,o)}})();const I=(e,t)=>t.some(n=>e instanceof n);let v,p;function x(){return v||(v=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function S(){return p||(p=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const w=new WeakMap,y=new WeakMap,m=new WeakMap;function A(e){const t=new Promise((n,i)=>{const r=()=>{e.removeEventListener("success",o),e.removeEventListener("error",s)},o=()=>{n(d(e.result)),r()},s=()=>{i(e.error),r()};e.addEventListener("success",o),e.addEventListener("error",s)});return m.set(t,e),t}function O(e){if(w.has(e))return;const t=new Promise((n,i)=>{const r=()=>{e.removeEventListener("complete",o),e.removeEventListener("error",s),e.removeEventListener("abort",s)},o=()=>{n(),r()},s=()=>{i(e.error||new DOMException("AbortError","AbortError")),r()};e.addEventListener("complete",o),e.addEventListener("error",s),e.addEventListener("abort",s)});w.set(e,t)}let h={get(e,t,n){if(e instanceof IDBTransaction){if(t==="done")return w.get(e);if(t==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return d(e[t])},set(e,t,n){return e[t]=n,!0},has(e,t){return e instanceof IDBTransaction&&(t==="done"||t==="store")?!0:t in e}};function P(e){h=e(h)}function k(e){return S().includes(e)?function(...t){return e.apply(B(this),t),d(this.request)}:function(...t){return d(e.apply(B(this),t))}}function $(e){return typeof e=="function"?k(e):(e instanceof IDBTransaction&&O(e),I(e,x())?new Proxy(e,h):e)}function d(e){if(e instanceof IDBRequest)return A(e);if(y.has(e))return y.get(e);const t=$(e);return t!==e&&(y.set(e,t),m.set(t,e)),t}const B=e=>m.get(e);function F(e,t,{blocked:n,upgrade:i,blocking:r,terminated:o}={}){const s=indexedDB.open(e,t),l=d(s);return i&&s.addEventListener("upgradeneeded",a=>{i(d(s.result),a.oldVersion,a.newVersion,d(s.transaction),a)}),n&&s.addEventListener("blocked",a=>n(a.oldVersion,a.newVersion,a)),l.then(a=>{o&&a.addEventListener("close",()=>o()),r&&a.addEventListener("versionchange",c=>r(c.oldVersion,c.newVersion,c))}).catch(()=>{}),l}const j=["get","getKey","getAll","getAllKeys","count"],V=["put","add","delete","clear"],g=new Map;function L(e,t){if(!(e instanceof IDBDatabase&&!(t in e)&&typeof t=="string"))return;if(g.get(t))return g.get(t);const n=t.replace(/FromIndex$/,""),i=t!==n,r=V.includes(n);if(!(n in(i?IDBIndex:IDBObjectStore).prototype)||!(r||j.includes(n)))return;const o=async function(s,...l){const a=this.transaction(s,r?"readwrite":"readonly");let c=a.store;return i&&(c=c.index(l.shift())),(await Promise.all([c[n](...l),r&&a.done]))[0]};return g.set(t,o),o}P(e=>({...e,get:(t,n,i)=>L(t,n)||e.get(t,n,i),has:(t,n)=>!!L(t,n)||e.has(t,n)}));const N=["continue","continuePrimaryKey","advance"],b={},E=new WeakMap,M=new WeakMap,W={get(e,t){if(!N.includes(t))return e[t];let n=b[t];return n||(n=b[t]=function(...i){E.set(this,M.get(this)[t](...i))}),n}};async function*H(...e){let t=this;if(t instanceof IDBCursor||(t=await t.openCursor(...e)),!t)return;t=t;const n=new Proxy(t,W);for(M.set(n,t),m.set(n,B(t));t;)yield n,t=await(E.get(n)||t.continue()),E.delete(n)}function D(e,t){return t===Symbol.asyncIterator&&I(e,[IDBIndex,IDBObjectStore,IDBCursor])||t==="iterate"&&I(e,[IDBIndex,IDBObjectStore])}P(e=>({...e,get(t,n,i){return D(t,n)?H:e.get(t,n,i)},has(t,n){return D(t,n)||e.has(t,n)}}));let u;async function q(){u=await F("WhereItItDB",1,{upgrade(e){if(!e.objectStoreNames.contains("items")){const t=e.createObjectStore("items",{keyPath:"id",autoIncrement:!0});t.createIndex("title","title"),t.createIndex("location","location")}}})}async function K(e){e.id?await u.put("items",e):(e.createdAt=new Date().toISOString(),await u.add("items",e))}async function C(){return await u.getAll("items")}async function R(e){await u.delete("items",e)}async function Q(e){const t=await C();if(!e)return t;const n=e.toLowerCase();return t.filter(i=>i.title.toLowerCase().includes(n)||i.location.toLowerCase().includes(n))}function T(e){return new Promise((t,n)=>{const i=new FileReader;i.onload=()=>t(i.result),i.onerror=n,i.readAsDataURL(e)})}async function f(e=null){const t=document.getElementById("itemsContainer");if(e||(e=await C()),e.length===0){t.innerHTML=`
            <div class="empty-state">
                <div style="font-size: 4rem;">üì¶</div>
                <p>Inga saker √§nnu. L√§gg till din f√∂rsta sak!</p>
            </div>
        `;return}t.innerHTML=e.map(n=>`
        <div class="item-card">
            <div class="item-image ${n.image?"":"placeholder"}">
                ${n.image?`<img src="${n.image}" alt="${n.title}" class="item-image">`:"üì¶"}
            </div>
            <div class="item-info">
                <h3>${n.title}</h3>
                <p>üìç ${n.location}</p>
                <p>üî¢ Antal: ${n.quantity}</p>
            </div>
            <div class="item-actions">
                <button class="btn-primary" onclick="editItem(${n.id})">√Ñndra</button>
                <button class="btn-danger" onclick="removeItem(${n.id})">Ta bort</button>
            </div>
        </div>
    `).join("")}window.editItem=async function(e){const t=await u.get("items",e);document.getElementById("itemTitle").value=t.title,document.getElementById("itemQuantity").value=t.quantity,document.getElementById("itemLocation").value=t.location,t.image&&(document.getElementById("imagePreview").innerHTML=`<img src="${t.image}" alt="Preview">`),document.getElementById("itemForm").dataset.editId=e,document.getElementById("cancelBtn").style.display="inline-block",document.querySelector(".add-item-section h2").textContent="√Ñndra sak",window.scrollTo({top:0,behavior:"smooth"})};window.removeItem=async function(e){confirm("√Ñr du s√§ker p√• att du vill ta bort denna sak?")&&(await R(e),await f())};document.getElementById("itemForm").addEventListener("submit",async e=>{e.preventDefault();const t=e.target,n=t.dataset.editId,i={title:document.getElementById("itemTitle").value,quantity:parseInt(document.getElementById("itemQuantity").value),location:document.getElementById("itemLocation").value};if(n){i.id=parseInt(n);const o=await u.get("items",i.id);i.image=o.image,i.createdAt=o.createdAt}const r=document.getElementById("itemImage").files[0];r&&(i.image=await T(r)),await K(i),t.reset(),delete t.dataset.editId,document.getElementById("imagePreview").innerHTML="",document.getElementById("cancelBtn").style.display="none",document.querySelector(".add-item-section h2").textContent="L√§gg till ny sak",await f()});document.getElementById("cancelBtn").addEventListener("click",()=>{const e=document.getElementById("itemForm");e.reset(),delete e.dataset.editId,document.getElementById("imagePreview").innerHTML="",document.getElementById("cancelBtn").style.display="none",document.querySelector(".add-item-section h2").textContent="L√§gg till ny sak"});document.getElementById("takePictureBtn").addEventListener("click",()=>{document.getElementById("itemImage").click()});document.getElementById("itemImage").addEventListener("change",async e=>{const t=e.target.files[0];if(t){const n=await T(t);document.getElementById("imagePreview").innerHTML=`<img src="${n}" alt="Preview">`}});document.getElementById("searchInput").addEventListener("input",async e=>{const t=e.target.value,n=await Q(t);await f(n)});async function z(){await q(),await f()}z();
