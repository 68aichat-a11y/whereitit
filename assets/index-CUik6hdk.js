(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))r(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerPolicy&&(i.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?i.credentials="include":a.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(a){if(a.ep)return;a.ep=!0;const i=n(a);fetch(a.href,i)}})();const H="modulepreload",U=function(e){return"/whereitit/"+e},C={},W=function(t,n,r){let a=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),c=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));a=Promise.allSettled(n.map(s=>{if(s=U(s),s in C)return;C[s]=!0;const l=s.endsWith(".css"),N=l?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${s}"]${N}`))return;const d=document.createElement("link");if(d.rel=l?"stylesheet":H,l||(d.as="script"),d.crossOrigin="",d.href=s,c&&d.setAttribute("nonce",c),document.head.appendChild(d),l)return new Promise((V,q)=>{d.addEventListener("load",V),d.addEventListener("error",()=>q(new Error(`Unable to preload CSS for ${s}`)))})}))}function i(o){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=o,window.dispatchEvent(c),!c.defaultPrevented)throw o}return a.then(o=>{for(const c of o||[])c.status==="rejected"&&i(c.reason);return t().catch(i)})},b=(e,t)=>t.some(n=>e instanceof n);let P,D;function _(){return P||(P=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function Q(){return D||(D=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const E=new WeakMap,p=new WeakMap,I=new WeakMap;function z(e){const t=new Promise((n,r)=>{const a=()=>{e.removeEventListener("success",i),e.removeEventListener("error",o)},i=()=>{n(m(e.result)),a()},o=()=>{r(e.error),a()};e.addEventListener("success",i),e.addEventListener("error",o)});return I.set(t,e),t}function G(e){if(E.has(e))return;const t=new Promise((n,r)=>{const a=()=>{e.removeEventListener("complete",i),e.removeEventListener("error",o),e.removeEventListener("abort",o)},i=()=>{n(),a()},o=()=>{r(e.error||new DOMException("AbortError","AbortError")),a()};e.addEventListener("complete",i),e.addEventListener("error",o),e.addEventListener("abort",o)});E.set(e,t)}let B={get(e,t,n){if(e instanceof IDBTransaction){if(t==="done")return E.get(e);if(t==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return m(e[t])},set(e,t,n){return e[t]=n,!0},has(e,t){return e instanceof IDBTransaction&&(t==="done"||t==="store")?!0:t in e}};function R(e){B=e(B)}function J(e){return Q().includes(e)?function(...t){return e.apply(k(this),t),m(this.request)}:function(...t){return m(e.apply(k(this),t))}}function X(e){return typeof e=="function"?J(e):(e instanceof IDBTransaction&&G(e),b(e,_())?new Proxy(e,B):e)}function m(e){if(e instanceof IDBRequest)return z(e);if(p.has(e))return p.get(e);const t=X(e);return t!==e&&(p.set(e,t),I.set(t,e)),t}const k=e=>I.get(e);function Y(e,t,{blocked:n,upgrade:r,blocking:a,terminated:i}={}){const o=indexedDB.open(e,t),c=m(o);return r&&o.addEventListener("upgradeneeded",s=>{r(m(o.result),s.oldVersion,s.newVersion,m(o.transaction),s)}),n&&o.addEventListener("blocked",s=>n(s.oldVersion,s.newVersion,s)),c.then(s=>{i&&s.addEventListener("close",()=>i()),a&&s.addEventListener("versionchange",l=>a(l.oldVersion,l.newVersion,l))}).catch(()=>{}),c}const Z=["get","getKey","getAll","getAllKeys","count"],ee=["put","add","delete","clear"],v=new Map;function T(e,t){if(!(e instanceof IDBDatabase&&!(t in e)&&typeof t=="string"))return;if(v.get(t))return v.get(t);const n=t.replace(/FromIndex$/,""),r=t!==n,a=ee.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(a||Z.includes(n)))return;const i=async function(o,...c){const s=this.transaction(o,a?"readwrite":"readonly");let l=s.store;return r&&(l=l.index(c.shift())),(await Promise.all([l[n](...c),a&&s.done]))[0]};return v.set(t,i),i}R(e=>({...e,get:(t,n,r)=>T(t,n)||e.get(t,n,r),has:(t,n)=>!!T(t,n)||e.has(t,n)}));const te=["continue","continuePrimaryKey","advance"],M={},L=new WeakMap,K=new WeakMap,ne={get(e,t){if(!te.includes(t))return e[t];let n=M[t];return n||(n=M[t]=function(...r){L.set(this,K.get(this)[t](...r))}),n}};async function*re(...e){let t=this;if(t instanceof IDBCursor||(t=await t.openCursor(...e)),!t)return;t=t;const n=new Proxy(t,ne);for(K.set(n,t),I.set(n,k(t));t;)yield n,t=await(L.get(n)||t.continue()),L.delete(n)}function x(e,t){return t===Symbol.asyncIterator&&b(e,[IDBIndex,IDBObjectStore,IDBCursor])||t==="iterate"&&b(e,[IDBIndex,IDBObjectStore])}R(e=>({...e,get(t,n,r){return x(t,n)?re:e.get(t,n,r)},has(t,n){return x(t,n)||e.has(t,n)}}));const ae={screwdriver:"Skruvmejsel",hammer:"Hammare",wrench:"Skiftnyckel",pliers:"T√•ng",drill:"Borr",saw:"S√•g",tool:"Verktyg",toolbox:"Verktygsl√•da",scissors:"Sax",knife:"Kniv",tape:"Tejp","measuring tape":"M√•ttband",level:"Vattenpass",ladder:"Stege",box:"L√•da","cardboard box":"Kartong","plastic box":"Plastl√•da",container:"Beh√•llare","storage box":"F√∂rvaringsl√•da",bin:"L√•da",crate:"L√•da",phone:"Telefon",smartphone:"Smartphone",laptop:"Laptop",computer:"Dator",tablet:"Surfplatta",keyboard:"Tangentbord",mouse:"Mus",cable:"Kabel",charger:"Laddare",battery:"Batteri",remote:"Fj√§rrkontroll",headphones:"H√∂rlurar",shirt:"Skjorta",jacket:"Jacka",shoes:"Skor",hat:"M√∂ssa",gloves:"Handskar",bag:"V√§ska",backpack:"Ryggs√§ck",book:"Bok",notebook:"Anteckningsbok",paper:"Papper",pen:"Penna",pencil:"Blyertspenna",folder:"Mapp",document:"Dokument",cup:"Kopp",mug:"Mugg",plate:"Tallrik",bowl:"Sk√•l",bottle:"Flaska",glass:"Glas",pot:"Gryta",pan:"Stekpanna",chair:"Stol",table:"Bord",shelf:"Hylla",drawer:"L√•da",cabinet:"Sk√•p",key:"Nyckel",watch:"Klocka",clock:"Klocka",lamp:"Lampa",light:"Lampa",toy:"Leksak",ball:"Boll",bicycle:"Cykel",car:"Bil"};function oe(e){if(!e)return"";const t=e.toLowerCase();for(const[r,a]of Object.entries(ae))if(t.includes(r))return a;const n=e.split(" ")[0];return n.charAt(0).toUpperCase()+n.slice(1)}let u,f=null,g=!1,y=null;function $(){const e=localStorage.getItem("enableAI");return e===null?!0:e==="true"}function ie(e){localStorage.setItem("enableAI",e.toString())}async function se(){u=await Y("WhereItItDB",1,{upgrade(e){if(!e.objectStoreNames.contains("items")){const t=e.createObjectStore("items",{keyPath:"id",autoIncrement:!0});t.createIndex("title","title"),t.createIndex("location","location")}}})}async function ce(e){e.id?await u.put("items",e):(e.createdAt=new Date().toISOString(),await u.add("items",e))}async function S(){return await u.getAll("items")}async function le(e){await u.delete("items",e)}async function de(e){const t=await S();if(!e)return t;const n=e.toLowerCase();return t.filter(r=>r.title.toLowerCase().includes(n)||r.location.toLowerCase().includes(n))}function F(e){return new Promise((t,n)=>{const r=new FileReader;r.onload=()=>t(r.result),r.onerror=n,r.readAsDataURL(e)})}async function ue(){if(y)return y;try{console.log("Laddar Transformers.js bibliotek...");const e=await W(()=>import("https://cdn.jsdelivr.net/npm/@xenova/transformers@2.17.0"),[]);return e.env.allowLocalModels=!1,e.env.useBrowserCache=!0,y=e,console.log("Transformers.js bibliotek laddat!"),e}catch(e){return console.error("Kunde inte ladda Transformers.js:",e),null}}async function me(){if(f)return f;if(g){for(;g;)await new Promise(e=>setTimeout(e,100));return f}try{g=!0,console.log("Laddar AI-modell f√∂r bildigenk√§nning...");const e=await ue();return e?(f=await e.pipeline("image-to-text","Xenova/vit-gpt2-image-captioning"),console.log("AI-modell laddad!"),f):null}catch(e){return console.error("Kunde inte ladda AI-modell:",e),null}finally{g=!1}}async function fe(e){try{const t=await me();if(!t)return console.log("AI-modell inte tillg√§nglig"),null;console.log("Analyserar bild...");const r=(await t(e))[0].generated_text;console.log("AI svarade:",r);const a=oe(r);return console.log("√ñversatt till:",a),a}catch(t){return console.error("Fel vid bildanalys:",t),null}}async function h(e=null){const t=document.getElementById("itemsContainer");if(e||(e=await S()),e.length===0){t.innerHTML=`
            <div class="empty-state">
                <div style="font-size: 4rem;">üì¶</div>
                <p>Inga saker √§nnu. L√§gg till din f√∂rsta sak!</p>
            </div>
        `;return}t.innerHTML=e.map(n=>`
        <div class="item-card" onclick="showItemModal(${n.id})">
            ${n.image?`<img src="${n.image}" alt="${n.title}" class="item-image">`:'<div class="item-image placeholder">üì¶</div>'}
            <div class="item-info">
                <h3>${n.title}</h3>
                <p>üìç ${n.location}</p>
            </div>
        </div>
    `).join("")}window.showItemModal=async function(e){const t=await u.get("items",e),n=document.getElementById("itemModal");document.getElementById("modalImage").src=t.image||"",document.getElementById("modalImage").style.display=t.image?"block":"none",document.getElementById("modalTitle").textContent=t.title,document.getElementById("modalQuantity").textContent=t.quantity,document.getElementById("modalLocation").textContent=t.location,document.getElementById("modalEdit").onclick=()=>{n.classList.remove("active"),editItem(e)},document.getElementById("modalDelete").onclick=()=>{n.classList.remove("active"),removeItem(e)},n.classList.add("active")};window.editItem=async function(e){const t=await u.get("items",e);document.getElementById("itemTitle").value=t.title,document.getElementById("itemQuantity").value=t.quantity,document.getElementById("itemLocation").value=t.location,t.image&&(document.getElementById("imagePreview").innerHTML=`<img src="${t.image}" alt="Preview">`),document.getElementById("itemForm").dataset.editId=e,document.getElementById("cancelBtn").style.display="inline-block",w("add")};window.removeItem=async function(e){confirm("√Ñr du s√§ker p√• att du vill ta bort denna sak?")&&(await le(e),await h())};function w(e){document.querySelectorAll(".tab-btn").forEach(t=>t.classList.remove("active")),document.querySelectorAll(".tab-content").forEach(t=>t.classList.remove("active")),document.querySelector(`[data-tab="${e}"]`).classList.add("active"),document.getElementById(`${e}Tab`).classList.add("active")}document.getElementById("itemForm").addEventListener("submit",async e=>{e.preventDefault();const t=e.target,n=t.dataset.editId,r={title:document.getElementById("itemTitle").value,quantity:parseInt(document.getElementById("itemQuantity").value),location:document.getElementById("itemLocation").value};if(n){r.id=parseInt(n);const i=await u.get("items",r.id);r.image=i.image,r.createdAt=i.createdAt}const a=document.getElementById("itemImage").files[0];a&&(r.image=await F(a)),await ce(r),t.reset(),delete t.dataset.editId,document.getElementById("imagePreview").innerHTML="",document.getElementById("cancelBtn").style.display="none",await h(),w("search")});document.getElementById("cancelBtn").addEventListener("click",()=>{const e=document.getElementById("itemForm");e.reset(),delete e.dataset.editId,document.getElementById("imagePreview").innerHTML="",document.getElementById("cancelBtn").style.display="none",w("search")});document.getElementById("takePictureBtn").addEventListener("click",()=>{document.getElementById("itemImage").click()});document.getElementById("itemImage").addEventListener("change",async e=>{const t=e.target.files[0];if(t){const n=await F(t);document.getElementById("imagePreview").innerHTML=`<img src="${n}" alt="Preview">`;const r=document.getElementById("itemTitle");if($()&&(!r.value||r.value.trim()==="")){r.placeholder="ü§ñ AI analyserar bilden...",r.disabled=!0;const i=URL.createObjectURL(t),o=await fe(i);o&&(r.value=o),r.placeholder="T.ex. Skruvmejsel",r.disabled=!1,URL.revokeObjectURL(i)}}});document.getElementById("searchInput").addEventListener("input",async e=>{const t=e.target.value,n=await de(t);await h(n)});document.querySelectorAll(".tab-btn").forEach(e=>{e.addEventListener("click",()=>{w(e.dataset.tab)})});document.querySelector(".close").addEventListener("click",()=>{document.getElementById("itemModal").classList.remove("active")});window.addEventListener("click",e=>{const t=document.getElementById("itemModal");e.target===t&&t.classList.remove("active")});async function ge(){try{return"caches"in window?(await caches.keys()).filter(n=>n.includes("transformers")||n.includes("huggingface")).length>0?"Nedladdad (~100 MB)":"Inte nedladdad":"Ok√§nd"}catch(e){return console.error("Kunde inte kontrollera cache:",e),"Ok√§nd"}}async function ye(){try{if("caches"in window){const t=(await caches.keys()).filter(n=>n.includes("transformers")||n.includes("huggingface")||n.includes("onnx"));for(const n of t)await caches.delete(n),console.log(`Rensade cache: ${n}`);return f=null,y=null,t.length}return 0}catch(e){throw console.error("Kunde inte rensa cache:",e),e}}async function A(){const e=await ge(),t=document.getElementById("aiStatus");t&&(t.textContent=e,t.style.color=e.includes("Nedladdad")?"var(--accent)":"var(--text-secondary)");const n=await S(),r=document.getElementById("itemCount");r&&(r.textContent=n.length);const a=document.getElementById("enableAI");a&&(a.checked=$())}var j;(j=document.getElementById("enableAI"))==null||j.addEventListener("change",e=>{ie(e.target.checked),console.log("AI-funktionalitet:",e.target.checked?"Aktiverad":"Inaktiverad")});var O;(O=document.getElementById("clearAICache"))==null||O.addEventListener("click",async()=>{if(confirm("√Ñr du s√§ker p√• att du vill rensa AI-modellen? Dina sparade saker p√•verkas inte."))try{const e=document.getElementById("clearAICache");e.disabled=!0,e.textContent="üîÑ Rensar...";const t=await ye();t>0?alert(`‚úÖ AI-modellen har rensats! ${t} cache(s) borttagna.`):alert("‚ÑπÔ∏è Ingen AI-modell hittades att rensa."),await A(),e.disabled=!1,e.textContent="üóëÔ∏è Rensa AI-modell (frig√∂r ~100 MB)"}catch(e){alert("‚ùå Kunde inte rensa AI-modellen: "+e.message);const t=document.getElementById("clearAICache");t.disabled=!1,t.textContent="üóëÔ∏è Rensa AI-modell (frig√∂r ~100 MB)"}});async function Ie(){await se(),await h(),await A(),document.querySelectorAll(".tab-btn").forEach(e=>{e.dataset.tab==="settings"&&e.addEventListener("click",A)})}Ie();
