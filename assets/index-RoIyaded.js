(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const a of o)if(a.type==="childList")for(const i of a.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&r(i)}).observe(document,{childList:!0,subtree:!0});function n(o){const a={};return o.integrity&&(a.integrity=o.integrity),o.referrerPolicy&&(a.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?a.credentials="include":o.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function r(o){if(o.ep)return;o.ep=!0;const a=n(o);fetch(o.href,a)}})();const R="modulepreload",V=function(e){return"/whereitit/"+e},S={},H=function(t,n,r){let o=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const i=document.querySelector("meta[property=csp-nonce]"),c=(i==null?void 0:i.nonce)||(i==null?void 0:i.getAttribute("nonce"));o=Promise.allSettled(n.map(s=>{if(s=V(s),s in S)return;S[s]=!0;const l=s.endsWith(".css"),F=l?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${s}"]${F}`))return;const d=document.createElement("link");if(d.rel=l?"stylesheet":R,l||(d.as="script"),d.crossOrigin="",d.href=s,c&&d.setAttribute("nonce",c),document.head.appendChild(d),l)return new Promise(($,K)=>{d.addEventListener("load",$),d.addEventListener("error",()=>K(new Error(`Unable to preload CSS for ${s}`)))})}))}function a(i){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=i,window.dispatchEvent(c),!c.defaultPrevented)throw i}return o.then(i=>{for(const c of i||[])c.status==="rejected"&&a(c.reason);return t().catch(a)})},b=(e,t)=>t.some(n=>e instanceof n);let P,D;function U(){return P||(P=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function q(){return D||(D=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const B=new WeakMap,w=new WeakMap,y=new WeakMap;function W(e){const t=new Promise((n,r)=>{const o=()=>{e.removeEventListener("success",a),e.removeEventListener("error",i)},a=()=>{n(m(e.result)),o()},i=()=>{r(e.error),o()};e.addEventListener("success",a),e.addEventListener("error",i)});return y.set(t,e),t}function _(e){if(B.has(e))return;const t=new Promise((n,r)=>{const o=()=>{e.removeEventListener("complete",a),e.removeEventListener("error",i),e.removeEventListener("abort",i)},a=()=>{n(),o()},i=()=>{r(e.error||new DOMException("AbortError","AbortError")),o()};e.addEventListener("complete",a),e.addEventListener("error",i),e.addEventListener("abort",i)});B.set(e,t)}let E={get(e,t,n){if(e instanceof IDBTransaction){if(t==="done")return B.get(e);if(t==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return m(e[t])},set(e,t,n){return e[t]=n,!0},has(e,t){return e instanceof IDBTransaction&&(t==="done"||t==="store")?!0:t in e}};function C(e){E=e(E)}function N(e){return q().includes(e)?function(...t){return e.apply(L(this),t),m(this.request)}:function(...t){return m(e.apply(L(this),t))}}function Q(e){return typeof e=="function"?N(e):(e instanceof IDBTransaction&&_(e),b(e,U())?new Proxy(e,E):e)}function m(e){if(e instanceof IDBRequest)return W(e);if(w.has(e))return w.get(e);const t=Q(e);return t!==e&&(w.set(e,t),y.set(t,e)),t}const L=e=>y.get(e);function z(e,t,{blocked:n,upgrade:r,blocking:o,terminated:a}={}){const i=indexedDB.open(e,t),c=m(i);return r&&i.addEventListener("upgradeneeded",s=>{r(m(i.result),s.oldVersion,s.newVersion,m(i.transaction),s)}),n&&i.addEventListener("blocked",s=>n(s.oldVersion,s.newVersion,s)),c.then(s=>{a&&s.addEventListener("close",()=>a()),o&&s.addEventListener("versionchange",l=>o(l.oldVersion,l.newVersion,l))}).catch(()=>{}),c}const G=["get","getKey","getAll","getAllKeys","count"],J=["put","add","delete","clear"],p=new Map;function T(e,t){if(!(e instanceof IDBDatabase&&!(t in e)&&typeof t=="string"))return;if(p.get(t))return p.get(t);const n=t.replace(/FromIndex$/,""),r=t!==n,o=J.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(o||G.includes(n)))return;const a=async function(i,...c){const s=this.transaction(i,o?"readwrite":"readonly");let l=s.store;return r&&(l=l.index(c.shift())),(await Promise.all([l[n](...c),o&&s.done]))[0]};return p.set(t,a),a}C(e=>({...e,get:(t,n,r)=>T(t,n)||e.get(t,n,r),has:(t,n)=>!!T(t,n)||e.has(t,n)}));const X=["continue","continuePrimaryKey","advance"],M={},k=new WeakMap,x=new WeakMap,Y={get(e,t){if(!X.includes(t))return e[t];let n=M[t];return n||(n=M[t]=function(...r){k.set(this,x.get(this)[t](...r))}),n}};async function*Z(...e){let t=this;if(t instanceof IDBCursor||(t=await t.openCursor(...e)),!t)return;t=t;const n=new Proxy(t,Y);for(x.set(n,t),y.set(n,L(t));t;)yield n,t=await(k.get(n)||t.continue()),k.delete(n)}function A(e,t){return t===Symbol.asyncIterator&&b(e,[IDBIndex,IDBObjectStore,IDBCursor])||t==="iterate"&&b(e,[IDBIndex,IDBObjectStore])}C(e=>({...e,get(t,n,r){return A(t,n)?Z:e.get(t,n,r)},has(t,n){return A(t,n)||e.has(t,n)}}));const ee={screwdriver:"Skruvmejsel",hammer:"Hammare",wrench:"Skiftnyckel",pliers:"T친ng",drill:"Borr",saw:"S친g",tool:"Verktyg",toolbox:"Verktygsl친da",scissors:"Sax",knife:"Kniv",tape:"Tejp","measuring tape":"M친ttband",level:"Vattenpass",ladder:"Stege",box:"L친da","cardboard box":"Kartong","plastic box":"Plastl친da",container:"Beh친llare","storage box":"F칬rvaringsl친da",bin:"L친da",crate:"L친da",phone:"Telefon",smartphone:"Smartphone",laptop:"Laptop",computer:"Dator",tablet:"Surfplatta",keyboard:"Tangentbord",mouse:"Mus",cable:"Kabel",charger:"Laddare",battery:"Batteri",remote:"Fj칛rrkontroll",headphones:"H칬rlurar",shirt:"Skjorta",jacket:"Jacka",shoes:"Skor",hat:"M칬ssa",gloves:"Handskar",bag:"V칛ska",backpack:"Ryggs칛ck",book:"Bok",notebook:"Anteckningsbok",paper:"Papper",pen:"Penna",pencil:"Blyertspenna",folder:"Mapp",document:"Dokument",cup:"Kopp",mug:"Mugg",plate:"Tallrik",bowl:"Sk친l",bottle:"Flaska",glass:"Glas",pot:"Gryta",pan:"Stekpanna",chair:"Stol",table:"Bord",shelf:"Hylla",drawer:"L친da",cabinet:"Sk친p",key:"Nyckel",watch:"Klocka",clock:"Klocka",lamp:"Lampa",light:"Lampa",toy:"Leksak",ball:"Boll",bicycle:"Cykel",car:"Bil"};function te(e){if(!e)return"";const t=e.toLowerCase();for(const[r,o]of Object.entries(ee))if(t.includes(r))return o;const n=e.split(" ")[0];return n.charAt(0).toUpperCase()+n.slice(1)}let u,f=null,g=!1,v=null;async function ne(){u=await z("WhereItItDB",1,{upgrade(e){if(!e.objectStoreNames.contains("items")){const t=e.createObjectStore("items",{keyPath:"id",autoIncrement:!0});t.createIndex("title","title"),t.createIndex("location","location")}}})}async function re(e){e.id?await u.put("items",e):(e.createdAt=new Date().toISOString(),await u.add("items",e))}async function j(){return await u.getAll("items")}async function oe(e){await u.delete("items",e)}async function ae(e){const t=await j();if(!e)return t;const n=e.toLowerCase();return t.filter(r=>r.title.toLowerCase().includes(n)||r.location.toLowerCase().includes(n))}function O(e){return new Promise((t,n)=>{const r=new FileReader;r.onload=()=>t(r.result),r.onerror=n,r.readAsDataURL(e)})}async function ie(){if(v)return v;try{console.log("Laddar Transformers.js bibliotek...");const e=await H(()=>import("https://cdn.jsdelivr.net/npm/@xenova/transformers@2.17.0"),[]);return e.env.allowLocalModels=!1,e.env.useBrowserCache=!0,v=e,console.log("Transformers.js bibliotek laddat!"),e}catch(e){return console.error("Kunde inte ladda Transformers.js:",e),null}}async function se(){if(f)return f;if(g){for(;g;)await new Promise(e=>setTimeout(e,100));return f}try{g=!0,console.log("Laddar AI-modell f칬r bildigenk칛nning...");const e=await ie();return e?(f=await e.pipeline("image-to-text","Xenova/vit-gpt2-image-captioning"),console.log("AI-modell laddad!"),f):null}catch(e){return console.error("Kunde inte ladda AI-modell:",e),null}finally{g=!1}}async function ce(e){try{const t=await se();if(!t)return console.log("AI-modell inte tillg칛nglig"),null;console.log("Analyserar bild...");const r=(await t(e))[0].generated_text;console.log("AI svarade:",r);const o=te(r);return console.log("칐versatt till:",o),o}catch(t){return console.error("Fel vid bildanalys:",t),null}}async function I(e=null){const t=document.getElementById("itemsContainer");if(e||(e=await j()),e.length===0){t.innerHTML=`
            <div class="empty-state">
                <div style="font-size: 4rem;">游닍</div>
                <p>Inga saker 칛nnu. L칛gg till din f칬rsta sak!</p>
            </div>
        `;return}t.innerHTML=e.map(n=>`
        <div class="item-card" onclick="showItemModal(${n.id})">
            ${n.image?`<img src="${n.image}" alt="${n.title}" class="item-image">`:'<div class="item-image placeholder">游닍</div>'}
            <div class="item-info">
                <h3>${n.title}</h3>
                <p>游늸 ${n.location}</p>
            </div>
        </div>
    `).join("")}window.showItemModal=async function(e){const t=await u.get("items",e),n=document.getElementById("itemModal");document.getElementById("modalImage").src=t.image||"",document.getElementById("modalImage").style.display=t.image?"block":"none",document.getElementById("modalTitle").textContent=t.title,document.getElementById("modalQuantity").textContent=t.quantity,document.getElementById("modalLocation").textContent=t.location,document.getElementById("modalEdit").onclick=()=>{n.classList.remove("active"),editItem(e)},document.getElementById("modalDelete").onclick=()=>{n.classList.remove("active"),removeItem(e)},n.classList.add("active")};window.editItem=async function(e){const t=await u.get("items",e);document.getElementById("itemTitle").value=t.title,document.getElementById("itemQuantity").value=t.quantity,document.getElementById("itemLocation").value=t.location,t.image&&(document.getElementById("imagePreview").innerHTML=`<img src="${t.image}" alt="Preview">`),document.getElementById("itemForm").dataset.editId=e,document.getElementById("cancelBtn").style.display="inline-block",h("add")};window.removeItem=async function(e){confirm("츿r du s칛ker p친 att du vill ta bort denna sak?")&&(await oe(e),await I())};function h(e){document.querySelectorAll(".tab-btn").forEach(t=>t.classList.remove("active")),document.querySelectorAll(".tab-content").forEach(t=>t.classList.remove("active")),document.querySelector(`[data-tab="${e}"]`).classList.add("active"),document.getElementById(`${e}Tab`).classList.add("active")}document.getElementById("itemForm").addEventListener("submit",async e=>{e.preventDefault();const t=e.target,n=t.dataset.editId,r={title:document.getElementById("itemTitle").value,quantity:parseInt(document.getElementById("itemQuantity").value),location:document.getElementById("itemLocation").value};if(n){r.id=parseInt(n);const a=await u.get("items",r.id);r.image=a.image,r.createdAt=a.createdAt}const o=document.getElementById("itemImage").files[0];o&&(r.image=await O(o)),await re(r),t.reset(),delete t.dataset.editId,document.getElementById("imagePreview").innerHTML="",document.getElementById("cancelBtn").style.display="none",await I(),h("search")});document.getElementById("cancelBtn").addEventListener("click",()=>{const e=document.getElementById("itemForm");e.reset(),delete e.dataset.editId,document.getElementById("imagePreview").innerHTML="",document.getElementById("cancelBtn").style.display="none",h("search")});document.getElementById("takePictureBtn").addEventListener("click",()=>{document.getElementById("itemImage").click()});document.getElementById("itemImage").addEventListener("change",async e=>{const t=e.target.files[0];if(t){const n=await O(t);document.getElementById("imagePreview").innerHTML=`<img src="${n}" alt="Preview">`;const r=document.getElementById("itemTitle");if(!r.value||r.value.trim()===""){r.placeholder="游뱄 AI analyserar bilden...",r.disabled=!0;const o=URL.createObjectURL(t),a=await ce(o);a&&(r.value=a),r.placeholder="T.ex. Skruvmejsel",r.disabled=!1,URL.revokeObjectURL(o)}}});document.getElementById("searchInput").addEventListener("input",async e=>{const t=e.target.value,n=await ae(t);await I(n)});document.querySelectorAll(".tab-btn").forEach(e=>{e.addEventListener("click",()=>{h(e.dataset.tab)})});document.querySelector(".close").addEventListener("click",()=>{document.getElementById("itemModal").classList.remove("active")});window.addEventListener("click",e=>{const t=document.getElementById("itemModal");e.target===t&&t.classList.remove("active")});async function le(){await ne(),await I()}le();
