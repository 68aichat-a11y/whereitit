(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))i(o);new MutationObserver(o=>{for(const r of o)if(r.type==="childList")for(const a of r.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&i(a)}).observe(document,{childList:!0,subtree:!0});function n(o){const r={};return o.integrity&&(r.integrity=o.integrity),o.referrerPolicy&&(r.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?r.credentials="include":o.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function i(o){if(o.ep)return;o.ep=!0;const r=n(o);fetch(o.href,r)}})();const w=(e,t)=>t.some(n=>e instanceof n);let L,p;function A(){return L||(L=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function k(){return p||(p=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const B=new WeakMap,I=new WeakMap,u=new WeakMap;function x(e){const t=new Promise((n,i)=>{const o=()=>{e.removeEventListener("success",r),e.removeEventListener("error",a)},r=()=>{n(l(e.result)),o()},a=()=>{i(e.error),o()};e.addEventListener("success",r),e.addEventListener("error",a)});return u.set(t,e),t}function O(e){if(B.has(e))return;const t=new Promise((n,i)=>{const o=()=>{e.removeEventListener("complete",r),e.removeEventListener("error",a),e.removeEventListener("abort",a)},r=()=>{n(),o()},a=()=>{i(e.error||new DOMException("AbortError","AbortError")),o()};e.addEventListener("complete",r),e.addEventListener("error",a),e.addEventListener("abort",a)});B.set(e,t)}let E={get(e,t,n){if(e instanceof IDBTransaction){if(t==="done")return B.get(e);if(t==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return l(e[t])},set(e,t,n){return e[t]=n,!0},has(e,t){return e instanceof IDBTransaction&&(t==="done"||t==="store")?!0:t in e}};function M(e){E=e(E)}function F(e){return k().includes(e)?function(...t){return e.apply(v(this),t),l(this.request)}:function(...t){return l(e.apply(v(this),t))}}function $(e){return typeof e=="function"?F(e):(e instanceof IDBTransaction&&O(e),w(e,A())?new Proxy(e,E):e)}function l(e){if(e instanceof IDBRequest)return x(e);if(I.has(e))return I.get(e);const t=$(e);return t!==e&&(I.set(e,t),u.set(t,e)),t}const v=e=>u.get(e);function j(e,t,{blocked:n,upgrade:i,blocking:o,terminated:r}={}){const a=indexedDB.open(e,t),m=l(a);return i&&a.addEventListener("upgradeneeded",s=>{i(l(a.result),s.oldVersion,s.newVersion,l(a.transaction),s)}),n&&a.addEventListener("blocked",s=>n(s.oldVersion,s.newVersion,s)),m.then(s=>{r&&s.addEventListener("close",()=>r()),o&&s.addEventListener("versionchange",d=>o(d.oldVersion,d.newVersion,d))}).catch(()=>{}),m}const V=["get","getKey","getAll","getAllKeys","count"],q=["put","add","delete","clear"],g=new Map;function b(e,t){if(!(e instanceof IDBDatabase&&!(t in e)&&typeof t=="string"))return;if(g.get(t))return g.get(t);const n=t.replace(/FromIndex$/,""),i=t!==n,o=q.includes(n);if(!(n in(i?IDBIndex:IDBObjectStore).prototype)||!(o||V.includes(n)))return;const r=async function(a,...m){const s=this.transaction(a,o?"readwrite":"readonly");let d=s.store;return i&&(d=d.index(m.shift())),(await Promise.all([d[n](...m),o&&s.done]))[0]};return g.set(t,r),r}M(e=>({...e,get:(t,n,i)=>b(t,n)||e.get(t,n,i),has:(t,n)=>!!b(t,n)||e.has(t,n)}));const W=["continue","continuePrimaryKey","advance"],D={},h=new WeakMap,C=new WeakMap,H={get(e,t){if(!W.includes(t))return e[t];let n=D[t];return n||(n=D[t]=function(...i){h.set(this,C.get(this)[t](...i))}),n}};async function*N(...e){let t=this;if(t instanceof IDBCursor||(t=await t.openCursor(...e)),!t)return;t=t;const n=new Proxy(t,H);for(C.set(n,t),u.set(n,v(t));t;)yield n,t=await(h.get(n)||t.continue()),h.delete(n)}function P(e,t){return t===Symbol.asyncIterator&&w(e,[IDBIndex,IDBObjectStore,IDBCursor])||t==="iterate"&&w(e,[IDBIndex,IDBObjectStore])}M(e=>({...e,get(t,n,i){return P(t,n)?N:e.get(t,n,i)},has(t,n){return P(t,n)||e.has(t,n)}}));let c;async function K(){c=await j("WhereItItDB",1,{upgrade(e){if(!e.objectStoreNames.contains("items")){const t=e.createObjectStore("items",{keyPath:"id",autoIncrement:!0});t.createIndex("title","title"),t.createIndex("location","location")}}})}async function R(e){e.id?await c.put("items",e):(e.createdAt=new Date().toISOString(),await c.add("items",e))}async function T(){return await c.getAll("items")}async function Q(e){await c.delete("items",e)}async function z(e){const t=await T();if(!e)return t;const n=e.toLowerCase();return t.filter(i=>i.title.toLowerCase().includes(n)||i.location.toLowerCase().includes(n))}function S(e){return new Promise((t,n)=>{const i=new FileReader;i.onload=()=>t(i.result),i.onerror=n,i.readAsDataURL(e)})}async function f(e=null){const t=document.getElementById("itemsContainer");if(e||(e=await T()),e.length===0){t.innerHTML=`
            <div class="empty-state">
                <div style="font-size: 4rem;">üì¶</div>
                <p>Inga saker √§nnu. L√§gg till din f√∂rsta sak!</p>
            </div>
        `;return}t.innerHTML=e.map(n=>`
        <div class="item-card" onclick="showItemModal(${n.id})">
            ${n.image?`<img src="${n.image}" alt="${n.title}" class="item-image">`:'<div class="item-image placeholder">üì¶</div>'}
            <div class="item-info">
                <h3>${n.title}</h3>
                <p>üìç ${n.location}</p>
            </div>
        </div>
    `).join("")}window.showItemModal=async function(e){const t=await c.get("items",e),n=document.getElementById("itemModal");document.getElementById("modalImage").src=t.image||"",document.getElementById("modalImage").style.display=t.image?"block":"none",document.getElementById("modalTitle").textContent=t.title,document.getElementById("modalQuantity").textContent=t.quantity,document.getElementById("modalLocation").textContent=t.location,document.getElementById("modalEdit").onclick=()=>{n.classList.remove("active"),editItem(e)},document.getElementById("modalDelete").onclick=()=>{n.classList.remove("active"),removeItem(e)},n.classList.add("active")};window.editItem=async function(e){const t=await c.get("items",e);document.getElementById("itemTitle").value=t.title,document.getElementById("itemQuantity").value=t.quantity,document.getElementById("itemLocation").value=t.location,t.image&&(document.getElementById("imagePreview").innerHTML=`<img src="${t.image}" alt="Preview">`),document.getElementById("itemForm").dataset.editId=e,document.getElementById("cancelBtn").style.display="inline-block",y("add")};window.removeItem=async function(e){confirm("√Ñr du s√§ker p√• att du vill ta bort denna sak?")&&(await Q(e),await f())};function y(e){document.querySelectorAll(".tab-btn").forEach(t=>t.classList.remove("active")),document.querySelectorAll(".tab-content").forEach(t=>t.classList.remove("active")),document.querySelector(`[data-tab="${e}"]`).classList.add("active"),document.getElementById(`${e}Tab`).classList.add("active")}document.getElementById("itemForm").addEventListener("submit",async e=>{e.preventDefault();const t=e.target,n=t.dataset.editId,i={title:document.getElementById("itemTitle").value,quantity:parseInt(document.getElementById("itemQuantity").value),location:document.getElementById("itemLocation").value};if(n){i.id=parseInt(n);const r=await c.get("items",i.id);i.image=r.image,i.createdAt=r.createdAt}const o=document.getElementById("itemImage").files[0];o&&(i.image=await S(o)),await R(i),t.reset(),delete t.dataset.editId,document.getElementById("imagePreview").innerHTML="",document.getElementById("cancelBtn").style.display="none",await f(),y("search")});document.getElementById("cancelBtn").addEventListener("click",()=>{const e=document.getElementById("itemForm");e.reset(),delete e.dataset.editId,document.getElementById("imagePreview").innerHTML="",document.getElementById("cancelBtn").style.display="none",y("search")});document.getElementById("takePictureBtn").addEventListener("click",()=>{document.getElementById("itemImage").click()});document.getElementById("itemImage").addEventListener("change",async e=>{const t=e.target.files[0];if(t){const n=await S(t);document.getElementById("imagePreview").innerHTML=`<img src="${n}" alt="Preview">`}});document.getElementById("searchInput").addEventListener("input",async e=>{const t=e.target.value,n=await z(t);await f(n)});document.querySelectorAll(".tab-btn").forEach(e=>{e.addEventListener("click",()=>{y(e.dataset.tab)})});document.querySelector(".close").addEventListener("click",()=>{document.getElementById("itemModal").classList.remove("active")});window.addEventListener("click",e=>{const t=document.getElementById("itemModal");e.target===t&&t.classList.remove("active")});async function U(){await K(),await f()}U();
